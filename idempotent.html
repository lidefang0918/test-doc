<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¹‚ç­‰æ€§ï¼ˆé˜²é‡å¤æäº¤ï¼‰ | ruoyi-vue-pro å¼€å‘æŒ‡å—</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .header {
            border-bottom: 1px solid #eee;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }
        .source-url {
            color: #666;
            font-size: 14px;
            margin-top: 10px;
        }
        .content-wrapper {
            line-height: 1.8;
        }
        img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 20px 0;
        }
        pre {
            background: #f6f8fa;
            padding: 16px;
            border-radius: 6px;
            overflow-x: auto;
        }
        code {
            background: #f6f8fa;
            padding: 2px 4px;
            border-radius: 3px;
            font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>å¹‚ç­‰æ€§ï¼ˆé˜²é‡å¤æäº¤ï¼‰ | ruoyi-vue-pro å¼€å‘æŒ‡å—</h1>
        <div class="source-url">åŸå§‹é“¾æ¥: <a href="https://doc.iocoder.cn/idempotent/">https://doc.iocoder.cn/idempotent/</a></div>
    </div>
    <div class="content-wrapper">
        <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">ç›®å½•</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">å¹‚ç­‰æ€§ï¼ˆé˜²é‡å¤æäº¤ï¼‰<!----></h1>  <div class="theme-vdoing-content content__default"><p><a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-framework/yudao-spring-boot-starter-protection/" target="_blank" rel="noopener noreferrer"><code>yudao-spring-boot-starter-protection</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æŠ€æœ¯ç»„ä»¶ï¼Œç”±å®ƒçš„ <a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-framework/yudao-spring-boot-starter-protection/src/main/java/cn/iocoder/yudao/framework/idempotent/" target="_blank" rel="noopener noreferrer"><code>idempotent</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> åŒ…ï¼Œæä¾›å£°æ˜å¼çš„å¹‚ç­‰ç‰¹æ€§ï¼Œå¯é˜²æ­¢é‡å¤è¯·æ±‚ã€‚ä¾‹å¦‚è¯´ï¼Œç”¨æˆ·å¿«é€Ÿçš„åŒå‡»äº†æŸä¸ªæŒ‰é’®ï¼Œå‰ç«¯æ²¡æœ‰ç¦ç”¨è¯¥æŒ‰é’®ï¼Œå¯¼è‡´å‘é€äº†ä¸¤æ¬¡é‡å¤çš„è¯·æ±‚ã€‚</p> <div class="language-Java extra-class"><pre class="language-java"><code><span class="token comment">// UserController.java</span>

<span class="token annotation punctuation">@Idempotent</span><span class="token punctuation">(</span>timeout <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> timeUnit <span class="token operator">=</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">"æ­£åœ¨æ·»åŠ ç”¨æˆ·ä¸­ï¼Œè¯·å‹¿é‡å¤æäº¤"</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/user/create"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">createUser</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span><span class="token punctuation">{</span>
    userService<span class="token punctuation">.</span><span class="token function">createUser</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token string">"æ·»åŠ æˆåŠŸ"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>æ¯ 10 ç§’é’Ÿï¼Œæ‰€æœ‰ç”¨æˆ·ï¼Œåªèƒ½æ“ä½œä¸€æ¬¡</li></ul> <div class="custom-block tip"><p class="custom-block-title">ç–‘é—®ï¼šå¦‚æœæƒ³æŒ‰ç…§æ¯ä¸ªç”¨æˆ·ï¼Œæˆ–è€…æ¯ä¸ª IPï¼Œé™åˆ¶è¯·æ±‚å‘¢ï¼Ÿ</p> <p>å¯è®¾ç½®è¯¥æ³¨è§£çš„ <code>keyResolver</code> å±æ€§ï¼Œå¯é€‰æ‹©çš„æœ‰ï¼š</p> <ul><li>DefaultIdempotentKeyResolverï¼šå…¨å±€çº§åˆ«</li> <li>UserIdempotentKeyResolverï¼šç”¨æˆ·çº§åˆ«</li> <li>ExpressionIdempotentKeyResolverï¼šè‡ªå®šä¹‰çº§åˆ«ï¼Œé€šè¿‡ <code>keyArg</code> å±æ€§æŒ‡å®š Spring EL è¡¨è¾¾å¼</li></ul></div> <h2 id="_1-å®ç°åŸç†"><a href="#_1-%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86" class="header-anchor">#</a> 1. å®ç°åŸç†</h2> <div class="custom-block tip"><p class="custom-block-title">å‹æƒ…æç¤ºï¼š</p> <p>å®ƒçš„å®ç°åŸç†ï¼Œå’Œ <a href="/rate-limiter/">ã€Šè¯·æ±‚é™æµï¼ˆRateLimiterï¼‰ã€‹</a> æ¯”è¾ƒæ¥è¿‘å“ˆã€‚</p></div> <p>å®ƒçš„å®ç°åŸç†éå¸¸ç®€å•ï¼Œé’ˆå¯¹ç›¸åŒå‚æ•°çš„æ–¹æ³•ï¼Œä¸€æ®µæ—¶é—´å†…ï¼Œæœ‰ä¸”ä»…èƒ½æ‰§è¡Œä¸€æ¬¡ã€‚æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š</p> <p>â‘  åœ¨æ–¹æ³•æ‰§è¡Œå‰ï¼Œæ ¹æ®å‚æ•°å¯¹åº”çš„ Key æŸ¥è¯¢æ˜¯å¦å­˜åœ¨ï¼š</p> <ul><li>å¦‚æœ<strong>å­˜åœ¨</strong>ï¼Œè¯´æ˜æ­£åœ¨æ‰§è¡Œä¸­ï¼Œåˆ™è¿›è¡ŒæŠ¥é”™ã€‚</li> <li>å¦‚æœ<strong>ä¸åœ¨</strong>ï¼Œåˆ™è®¡ç®—å‚æ•°å¯¹åº”çš„ Keyï¼Œå­˜å‚¨åˆ° Redis ä¸­ï¼Œå¹¶è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œå³æ ‡è®°æ­£åœ¨æ‰§è¡Œä¸­ã€‚</li></ul> <p>é»˜è®¤å‚æ•°çš„ Redis Key çš„è®¡ç®—è§„åˆ™ç”± <a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-framework/yudao-spring-boot-starter-protection/src/main/java/cn/iocoder/yudao/framework/idempotent/core/keyresolver/impl/DefaultIdempotentKeyResolver.java" target="_blank" rel="noopener noreferrer">DefaultIdempotentKeyResolver<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> å®ç°ï¼Œä½¿ç”¨ MD5(æ–¹æ³•å + æ–¹æ³•å‚æ•°)ï¼Œé¿å… Redis Key è¿‡é•¿ã€‚</p> <p>â‘¡ æ–¹æ³•æ‰§è¡Œå®Œæˆï¼Œ<strong>ä¸ä¼š</strong>ä¸»åŠ¨åˆ é™¤å‚æ•°å¯¹åº”çš„ Keyã€‚</p> <p>å¦‚æœå¸Œæœ›ä¼š<strong>ä¸»åŠ¨</strong>åˆ é™¤ Keyï¼Œå¯ä»¥ä½¿ç”¨ <a href="/distributed-lock">ã€Šå¼€å‘æŒ‡å— â€”â€” åˆ†å¸ƒå¼é”ã€‹</a> æä¾›çš„ <code>@Lock</code> æ¥å®ç°å¹‚ç­‰æ€§ã€‚</p> <p>ğŸ™‚ ä»æœ¬è´¨ä¸Šæ¥è¯´ï¼Œ<code>idempotent</code> åŒ…æä¾›çš„å¹‚ç­‰ç‰¹æ€§ï¼Œæœ¬è´¨ä¸Šä¹Ÿæ˜¯åŸºäº Redis å®ç°çš„åˆ†å¸ƒå¼é”ã€‚</p> <p>â‘¢ å¦‚æœæ–¹æ³•æ‰§è¡Œæ—¶é—´è¾ƒé•¿ï¼Œè¶…è¿‡ Key çš„è¿‡æœŸæ—¶é—´ï¼Œåˆ™ Redis ä¼šè‡ªåŠ¨åˆ é™¤å¯¹åº”çš„ Keyã€‚å› æ­¤ï¼Œéœ€è¦å¤§æ¦‚è¯„ä¼°ä¸‹ï¼Œé¿å…æ–¹æ³•çš„æ‰§è¡Œæ—¶é—´è¶…è¿‡è¿‡æœŸæ—¶é—´ã€‚</p> <p>â‘£ å¦‚æœæ–¹æ³•æ‰§è¡Œå‘ç”Ÿ Exception å¼‚å¸¸æ—¶ï¼Œé»˜è®¤ä¼šåˆ é™¤ Keyï¼Œé¿å…ä¸‹æ¬¡è¯·æ±‚æ— æ³•æ­£å¸¸æ‰§è¡Œï¼Œæ­¤å¤„å‚è€ƒ <a href="https://tech.meituan.com/2016/09/29/distributed-system-mutually-exclusive-idempotence-cerberus-gtis.html" target="_blank" rel="noopener noreferrer">ã€Šç¾å›¢ GTISã€‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ã€‚</p> <h2 id="_2-idempotent-æ³¨è§£"><a href="#_2-idempotent-%E6%B3%A8%E8%A7%A3" class="header-anchor">#</a> 2. <code>@Idempotent</code> æ³¨è§£</h2> <p><a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-framework/yudao-spring-boot-starter-protection/src/main/java/cn/iocoder/yudao/framework/idempotent/core/annotation/Idempotent.java" target="_blank" rel="noopener noreferrer"><code>@Idempotent</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ³¨è§£ï¼Œå£°æ˜åœ¨æ–¹æ³•ä¸Šï¼Œè¡¨ç¤ºè¯¥æ–¹æ³•éœ€è¦å¼€å¯å¹‚ç­‰æ€§ã€‚ä»£ç å¦‚ä¸‹ï¼š</p> <p><img src="/img/%E5%90%8E%E7%AB%AF%E6%89%8B%E5%86%8C/%E5%B9%82%E7%AD%89%E6%80%A7/%E6%B3%A8%E8%A7%A3.png" alt=" æ³¨è§£"></p> <p>â‘  å¯¹åº”çš„ AOP åˆ‡é¢æ˜¯ <a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-framework/yudao-spring-boot-starter-protection/src/main/java/cn/iocoder/yudao/framework/idempotent/core/aop/IdempotentAspect.java" target="_blank" rel="noopener noreferrer">IdempotentAspect<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç±»ï¼Œæ ¸å¿ƒå°± 10 è¡Œå·¦å³çš„ä»£ç ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p> <p><img src="/img/%E5%90%8E%E7%AB%AF%E6%89%8B%E5%86%8C/%E5%B9%82%E7%AD%89%E6%80%A7/IdempotentAspect.png" alt="IdempotentAspect åˆ‡é¢"></p> <p>â‘¡ å¯¹åº”çš„ Redis Key çš„å‰ç¼€æ˜¯ <code>idempotent:%s</code>ï¼Œå¯è§ <a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-framework/yudao-spring-boot-starter-protection/src/main/java/cn/iocoder/yudao/framework/idempotent/core/redis/IdempotentRedisDAO.java" target="_blank" rel="noopener noreferrer">IdempotentRedisDAO<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç±»ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p> <p><img src="/img/%E5%90%8E%E7%AB%AF%E6%89%8B%E5%86%8C/%E5%B9%82%E7%AD%89%E6%80%A7/IdempotentRedisDAO.png" alt="IdempotentRedisDAO å­˜å‚¨"></p> <h2 id="_3-ä½¿ç”¨ç¤ºä¾‹"><a href="#_3-%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B" class="header-anchor">#</a> 3. ä½¿ç”¨ç¤ºä¾‹</h2> <p>æœ¬å°èŠ‚ï¼Œæˆ‘ä»¬å®ç° <code>/admin-api/infra/test-demo/get</code> RESTful API æ¥å£çš„å¹‚ç­‰æ€§ã€‚</p> <p>â‘  åœ¨ <code>pom.xml</code> æ–‡ä»¶ä¸­ï¼Œå¼•å…¥ <code>yudao-spring-boot-starter-protection</code> ä¾èµ–ã€‚</p> <div class="language-XML extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>cn.iocoder.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>yudao-spring-boot-starter-protection<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>â‘¡ åœ¨è¯¥ API æ¥å£çš„å¯¹åº”æ–¹æ³•ä¸Šï¼Œæ·»åŠ  <code>@Idempotent</code> æ³¨è§£ã€‚ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language-Java extra-class"><pre class="language-java"><code><span class="token comment">// TestDemoController.java</span>

<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/get"</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Idempotent</span><span class="token punctuation">(</span>timeout <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">"é‡å¤è¯·æ±‚ï¼Œè¯·ç¨åé‡è¯•"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TestDemoRespVO</span><span class="token punctuation">&gt;</span></span> <span class="token function">getTestDemo</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ... çœç•¥ä»£ç </span>
<span class="token punctuation">}</span>
</code></pre></div><p>â‘¢ è°ƒç”¨è¯¥ API æ¥å£ï¼Œæ‰§è¡ŒæˆåŠŸã€‚</p> <p><img src="/img/%E5%90%8E%E7%AB%AF%E6%89%8B%E5%86%8C/%E5%B9%82%E7%AD%89%E6%80%A7/%E6%A1%88%E4%BE%8B.png" alt="è°ƒç”¨æˆåŠŸ"></p> <p>â‘£ å†æ¬¡è°ƒç”¨è¯¥ API æ¥å£ï¼Œè¢«å¹‚ç­‰æ€§æ‹¦æˆªï¼Œæ‰§è¡Œå¤±è´¥ã€‚</p> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">"code"</span><span class="token operator">:</span> <span class="token number">900</span><span class="token punctuation">,</span>
  <span class="token property">"data"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
  <span class="token property">"msg"</span><span class="token operator">:</span> <span class="token string">"é‡å¤è¯·æ±‚ï¼Œè¯·ç¨åé‡è¯•"</span>
<span class="token punctuation">}</span>
</code></pre></div></div></div>
    </div>
</body>
</html>