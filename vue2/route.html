<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>菜单路由 | ruoyi-vue-pro 开发指南</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .header {
            border-bottom: 1px solid #eee;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }
        .source-url {
            color: #666;
            font-size: 14px;
            margin-top: 10px;
        }
        .content-wrapper {
            line-height: 1.8;
        }
        img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 20px 0;
        }
        pre {
            background: #f6f8fa;
            padding: 16px;
            border-radius: 6px;
            overflow-x: auto;
        }
        code {
            background: #f6f8fa;
            padding: 2px 4px;
            border-radius: 3px;
            font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>菜单路由 | ruoyi-vue-pro 开发指南</h1>
        <div class="source-url">原始链接: <a href="https://doc.iocoder.cn/vue2/route/">https://doc.iocoder.cn/vue2/route/</a></div>
    </div>
    <div class="content-wrapper">
        <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">菜单路由<!----></h1>  <div class="theme-vdoing-content content__default"><p>前端项目基于 element-ui-admin 实现，它的 <a href="https://panjiachen.github.io/vue-element-admin-site/zh/guide/essentials/router-and-nav.html#%E9%85%8D%E7%BD%AE%E9%A1%B9" target="_blank" rel="noopener noreferrer">路由和侧边栏<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 是组织起一个后台应用的关键骨架。</p> <p>侧边栏和路由是绑定在一起的，所以你只有在 <a href="https://github.com/yudaocode/yudao-ui-admin-vue2/blob/master/src/router/index.js" target="_blank" rel="noopener noreferrer">@/router/index.js<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 下面配置对应的路由，侧边栏就能动态的生成了，大大减轻了手动重复编辑侧边栏的工作量。</p> <p>当然，这样就需要在配置路由的时候，遵循一些约定的规则。</p> <h2 id="_1-路由配置"><a href="#_1-%E8%B7%AF%E7%94%B1%E9%85%8D%E7%BD%AE" class="header-anchor">#</a> 1. 路由配置</h2> <p>首先，我们了解一下本项目配置路由时，提供了哪些配置项：</p> <div class="language-JS extra-class"><pre class="language-js"><code><span class="token comment">// 当设置 true 的时候该路由不会在侧边栏出现 如 401，login 等页面，或者如一些编辑页面 /edit/1</span>
<span class="token literal-property property">hidden</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">// (默认 false)</span>

<span class="token comment">// 当设置 noRedirect 的时候该路由在面包屑导航中不可被点击</span>
<span class="token literal-property property">redirect</span><span class="token operator">:</span> <span class="token string">'noRedirect'</span>

<span class="token comment">// 1. 当你一个路由下面的 children 声明的路由大于 1 个时，自动会变成嵌套的模式。例如说，组件页面</span>
<span class="token comment">// 2. 只有一个时，会将那个子路由当做根路由显示在侧边栏。例如说，如引导页面</span>
<span class="token comment">// 若你想不管路由下面的 children 声明的个数都显示你的根路由，</span>
<span class="token comment">// 你可以设置 alwaysShow: true，这样它就会忽略之前定义的规则，一直显示根路由</span>
<span class="token literal-property property">alwaysShow</span><span class="token operator">:</span> <span class="token boolean">true</span>

<span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'router-name'</span> <span class="token comment">// 设定路由的名字，一定要填写不然使用 &lt;keep-alive&gt; 时会出现各种问题</span>
<span class="token literal-property property">meta</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">roles</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'admin'</span><span class="token punctuation">,</span> <span class="token string">'editor'</span><span class="token punctuation">]</span> <span class="token comment">// 设置该路由进入的权限，支持多个权限叠加</span>
  <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'title'</span> <span class="token comment">// 设置该路由在侧边栏和面包屑中展示的名字</span>
  <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token string">'svg-name'</span> <span class="token comment">// 设置该路由的图标，支持 svg-class，也支持 el-icon-x element-ui 的 icon</span>
  <span class="token literal-property property">noCache</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">// 如果设置为 true，则不会被 &lt;keep-alive&gt; 缓存(默认 false)</span>
  <span class="token literal-property property">breadcrumb</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token comment">//  如果设置为 false，则不会在breadcrumb面包屑中显示(默认 true)</span>
  <span class="token literal-property property">affix</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">// 如果设置为 true，它则会固定在 tags-view 中(默认 false)</span>

  <span class="token comment">// 当路由设置了该属性，则会高亮相对应的侧边栏。</span>
  <span class="token comment">// 这在某些场景非常有用，比如：一个文章的列表页路由为：/article/list</span>
  <span class="token comment">// 点击文章进入文章详情页，这时候路由为 /article/1，但你想在侧边栏高亮文章列表的路由，就可以进行如下设置</span>
  <span class="token literal-property property">activeMenu</span><span class="token operator">:</span> <span class="token string">'/article/list'</span>
<span class="token punctuation">}</span>
</code></pre></div><p>普通示例</p> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  path<span class="token operator">:</span> '/system/test'<span class="token punctuation">,</span>
  component<span class="token operator">:</span> Layout<span class="token punctuation">,</span>
  redirect<span class="token operator">:</span> 'noRedirect'<span class="token punctuation">,</span>
  hidden<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  alwaysShow<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  meta<span class="token operator">:</span> <span class="token punctuation">{</span> title<span class="token operator">:</span> '系统管理'<span class="token punctuation">,</span> icon <span class="token operator">:</span> <span class="token string">"system"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  children<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
    path<span class="token operator">:</span> 'index'<span class="token punctuation">,</span>
    component<span class="token operator">:</span> (resolve) =&gt; require(<span class="token punctuation">[</span>'@/views/index'<span class="token punctuation">]</span><span class="token punctuation">,</span> resolve)<span class="token punctuation">,</span>
    name<span class="token operator">:</span> 'Test'<span class="token punctuation">,</span>
    meta<span class="token operator">:</span> <span class="token punctuation">{</span>
      title<span class="token operator">:</span> '测试管理'<span class="token punctuation">,</span>
      icon<span class="token operator">:</span> 'user'
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>外链示例</p> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  path<span class="token operator">:</span> 'https<span class="token operator">:</span><span class="token comment">//www.iocoder.cn',</span>
  meta<span class="token operator">:</span> <span class="token punctuation">{</span> title<span class="token operator">:</span> '芋道源码'<span class="token punctuation">,</span> icon <span class="token operator">:</span> <span class="token string">"guide"</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_2-路由"><a href="#_2-%E8%B7%AF%E7%94%B1" class="header-anchor">#</a> 2. 路由</h2> <p>项目的路由分为两种：静态路由、动态路由。</p> <h3 id="_2-1-静态路由"><a href="#_2-1-%E9%9D%99%E6%80%81%E8%B7%AF%E7%94%B1" class="header-anchor">#</a> 2.1 静态路由</h3> <p>静态路由，代表那些不需要动态判断权限的路由，如登录页、404、个人中心等通用页面。</p> <p>在 <a href="https://github.com/yudaocode/yudao-ui-admin-vue2/blob/master/src/router/index.js" target="_blank" rel="noopener noreferrer">@/router/index.js<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 的 <code>constantRoutes</code>，就是配置对应的公共路由。如下图所示：</p> <p><img src="/img/Vue2/%E8%8F%9C%E5%8D%95%E8%B7%AF%E7%94%B1/01.png" alt="静态路由"></p> <h3 id="_2-2-动态路由"><a href="#_2-2-%E5%8A%A8%E6%80%81%E8%B7%AF%E7%94%B1" class="header-anchor">#</a> 2.2 动态路由</h3> <p>动态路由，代表那些需要根据用户动态判断权限，并通过 <a href="https://router.vuejs.org/guide/advanced/dynamic-routing.html#adding-routes" target="_blank" rel="noopener noreferrer">addRoutes<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 动态添加的页面，如用户管理、角色管理等功能页面。</p> <p>在用户登录成功后，会触发 <a href="https://github.com/yudaocode/yudao-ui-admin-vue2/blob/master/src/store/modules/permission.js#L29" target="_blank" rel="noopener noreferrer"><code>@/store/modules/permission.js</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 请求后端的菜单 RESTful API 接口，获取用户<strong>有权限</strong>的菜单列表，并转化添加到路由中。如下图所示：</p> <p><img src="/img/Vue2/%E8%8F%9C%E5%8D%95%E8%B7%AF%E7%94%B1/02.png" alt="动态路由"></p> <div class="custom-block tip"><p class="custom-block-title">友情提示：</p> <ol><li>动态路由可以在 [系统管理 -&gt; 菜单管理] 进行新增和修改操作，请求的后端 RESTful API 接口是 <a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-system/src/main/java/cn/iocoder/yudao/module/system/controller/admin/auth/AuthController.java#L107-L110" target="_blank" rel="noopener noreferrer"><code>/admin-api/system/auth/get-permission-info</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>动态路由在生产环境下会默认使用路由懒加载，实现方式参考 <a href="https://github.com/yudaocode/yudao-ui-admin-vue2/blob/master/src/store/modules/permission.js#L108-L110" target="_blank" rel="noopener noreferrer">loadView<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 方法的判断</li></ol></div> <h3 id="_2-3-路由跳转"><a href="#_2-3-%E8%B7%AF%E7%94%B1%E8%B7%B3%E8%BD%AC" class="header-anchor">#</a> 2.3 路由跳转</h3> <p>使用 <code>router.push</code> 方法，可以实现跳转到不同的页面。</p> <div class="language-JS extra-class"><pre class="language-js"><code><span class="token comment">// 简单跳转</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">"/system/user"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 跳转页面并设置请求参数，使用 `query` 属性</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">"/system/user"</span><span class="token punctuation">,</span> <span class="token literal-property property">query</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"芋道"</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_3-菜单管理"><a href="#_3-%E8%8F%9C%E5%8D%95%E7%AE%A1%E7%90%86" class="header-anchor">#</a> 3. 菜单管理</h2> <p>项目的菜单在 [系统管理 -&gt; 菜单管理] 进行管理，支持<strong>无限</strong>层级，提供目录、菜单、按钮三种类型。如下图所示：</p> <p><img src="/img/Vue2/%E8%8F%9C%E5%8D%95%E8%B7%AF%E7%94%B1/03.png" alt="系统管理 -&gt; 菜单管理"></p> <p>菜单可在 [系统管理 -&gt; 角色管理] 被分配给角色。如下图所示：</p> <p><img src="/img/Vue2/%E8%8F%9C%E5%8D%95%E8%B7%AF%E7%94%B1/04.png" alt="系统管理 -&gt; 角色管理"></p> <h3 id="_3-1-新增目录"><a href="#_3-1-%E6%96%B0%E5%A2%9E%E7%9B%AE%E5%BD%95" class="header-anchor">#</a> 3.1 新增目录</h3> <p>① 大多数情况下，目录是作为菜单的【分类】：</p> <p><img src="/img/Vue2/%E8%8F%9C%E5%8D%95%E8%B7%AF%E7%94%B1/05.png" alt="新增目录 —— 菜单的分类"></p> <p>② 目录也提供实现【外链】的能力：</p> <p><img src="/img/Vue2/%E8%8F%9C%E5%8D%95%E8%B7%AF%E7%94%B1/06.png" alt="新增目录 —— 外链"></p> <h3 id="_3-2-新增菜单"><a href="#_3-2-%E6%96%B0%E5%A2%9E%E8%8F%9C%E5%8D%95" class="header-anchor">#</a> 3.2 新增菜单</h3> <p><img src="/img/Vue2/%E8%8F%9C%E5%8D%95%E8%B7%AF%E7%94%B1/07.png" alt="新增菜单"></p> <h3 id="_3-3-新增按钮"><a href="#_3-3-%E6%96%B0%E5%A2%9E%E6%8C%89%E9%92%AE" class="header-anchor">#</a> 3.3 新增按钮</h3> <p><img src="/img/Vue2/%E8%8F%9C%E5%8D%95%E8%B7%AF%E7%94%B1/08.png" alt="新增按钮"></p> <h2 id="_4-权限控制"><a href="#_4-%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6" class="header-anchor">#</a> 4. 权限控制</h2> <p>前端通过权限控制，隐藏用户没有权限的按钮等，实现功能级别的权限。</p> <div class="custom-block tip"><p class="custom-block-title">友情提示：前端的权限控制，主要是提升用户体验，避免操作后发现没有权限。</p> <p>最终在请求到后端时，还是会进行一次权限的校验。</p></div> <h3 id="_4-1-v-haspermi-指令"><a href="#_4-1-v-haspermi-%E6%8C%87%E4%BB%A4" class="header-anchor">#</a> 4.1 v-hasPermi 指令</h3> <p><a href="https://github.com/yudaocode/yudao-ui-admin-vue2/blob/master/src/directive/permission/hasPermi.js" target="_blank" rel="noopener noreferrer"><code>v-hasPermi</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 指令，基于权限字符，进行权限的控制。</p> <div class="language-HTML extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- 单个 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">v-hasPermi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>['system:user:create']<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>存在权限字符串才能看到<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 多个，满足任一一个即可 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">v-hasPermi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>['system:user:create', 'system:user:update']<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>包含权限字符串才能看到<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="_4-2-v-hasrole-指令"><a href="#_4-2-v-hasrole-%E6%8C%87%E4%BB%A4" class="header-anchor">#</a> 4.2 v-hasRole 指令</h3> <p><a href="https://github.com/yudaocode/yudao-ui-admin-vue2/blob/master/src/directive/permission/hasRole.js" target="_blank" rel="noopener noreferrer"><code>v-hasRole</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 指令，基于角色标识，机进行的控制。</p> <div class="language-HTML extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- 单个 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">v-hasRole</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>['admin']<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>管理员才能看到<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 多个，满足任一一个即可 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">v-hasRole</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>['role1', 'role2']<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>包含角色才能看到<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="_4-3-结合-v-if-指令"><a href="#_4-3-%E7%BB%93%E5%90%88-v-if-%E6%8C%87%E4%BB%A4" class="header-anchor">#</a> 4.3 结合 v-if 指令</h3> <p>在某些情况下，它是不适合使用 <code>v-hasPermi</code> 或 <code>v-hasRole</code> 指令，如元素标签组件。此时，只能通过手动设置 <code>v-if</code>，通过使用全局权限判断函数，用法是基本一致的。</p> <div class="language-HTML extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-tabs</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-tab-pane</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>checkPermi(['system:user:create'])<span class="token punctuation">"</span></span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>用户管理<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>user<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>用户管理<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-tab-pane</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-tab-pane</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>checkPermi(['system:user:create', 'system:user:update'])<span class="token punctuation">"</span></span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>参数管理<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>menu<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>参数管理<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-tab-pane</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-tab-pane</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>checkRole(['admin'])<span class="token punctuation">"</span></span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>角色管理<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>role<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>角色管理<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-tab-pane</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-tab-pane</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>checkRole(['admin','common'])<span class="token punctuation">"</span></span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>定时任务<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>job<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>定时任务<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-tab-pane</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-tabs</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> checkPermi<span class="token punctuation">,</span> checkRole <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@/utils/permission"</span><span class="token punctuation">;</span> <span class="token comment">// 权限判断函数</span>

<span class="token keyword">export</span> <span class="token keyword">default</span><span class="token punctuation">{</span>
   <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    checkPermi<span class="token punctuation">,</span>
    checkRole
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="_5-页面缓存"><a href="#_5-%E9%A1%B5%E9%9D%A2%E7%BC%93%E5%AD%98" class="header-anchor">#</a> 5. 页面缓存</h2> <p>由于目前 <code>keep-alive</code> 和 <code>router-view</code> 是强耦合的，而且查看 Vue 的文档和源码不难发现 <code>keep-alive</code> 的 <code>include</code> 默认是优先匹配组件的 <code>name</code> ，所以在编写路由 <code>router</code> 和路由对应的 view component 的时候一定要确保两者的 name 是完全一致的。</p> <p>注意，切记 view component 的 <code>name</code> 命名时候尽量保证唯一性，切记不要和某些组件的命名重复了，不然会递归引用最后内存溢出等问题。</p> <div class="custom-block tip"><p class="custom-block-title">友情提示：页面缓存是什么？</p> <p>简单来说，Tab 切换时，开启页面缓存的 Tab 保持原本的状态，不进行刷新（不请求数据）。</p> <p>详细可见 <a href="https://vuejs.org/guide/built-ins/keep-alive.html" target="_blank" rel="noopener noreferrer">Vue 文档 —— KeepAlive<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <h3 id="_5-1-静态路由的示例"><a href="#_5-1-%E9%9D%99%E6%80%81%E8%B7%AF%E7%94%B1%E7%9A%84%E7%A4%BA%E4%BE%8B" class="header-anchor">#</a> 5.1 静态路由的示例</h3> <p>① router 路由的 <code>name</code> 声明如下：</p> <div class="language-JS extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'create-form'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/form/create'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'createForm'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">meta</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'createForm'</span><span class="token punctuation">,</span> <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token string">'table'</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>② view component 的 <code>name</code> 声明如下：</p> <div class="language-JS extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'createForm'</span>
<span class="token punctuation">}</span>
</code></pre></div><p>一定要保证两者的名字相同，切记写重或者写错。默认如果不写 <code>name</code> 就不会被缓存，详情见 <a href="https://github.com/vuejs/vue/issues/6938#issuecomment-345728620" target="_blank" rel="noopener noreferrer">issue<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h3 id="_5-2-动态路由的示例"><a href="#_5-2-%E5%8A%A8%E6%80%81%E8%B7%AF%E7%94%B1%E7%9A%84%E7%A4%BA%E4%BE%8B" class="header-anchor">#</a> 5.2 动态路由的示例</h3> <p><img src="/img/Vue2/%E8%8F%9C%E5%8D%95%E8%B7%AF%E7%94%B1/09.png" alt="示例"></p></div></div>
    </div>
</body>
</html>