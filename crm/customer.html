<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>【客户】客户管理、公海客户 | ruoyi-vue-pro 开发指南</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .header {
            border-bottom: 1px solid #eee;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }
        .source-url {
            color: #666;
            font-size: 14px;
            margin-top: 10px;
        }
        .content-wrapper {
            line-height: 1.8;
        }
        img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 20px 0;
        }
        pre {
            background: #f6f8fa;
            padding: 16px;
            border-radius: 6px;
            overflow-x: auto;
        }
        code {
            background: #f6f8fa;
            padding: 2px 4px;
            border-radius: 3px;
            font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>【客户】客户管理、公海客户 | ruoyi-vue-pro 开发指南</h1>
        <div class="source-url">原始链接: <a href="https://doc.iocoder.cn/crm/customer/">https://doc.iocoder.cn/crm/customer/</a></div>
    </div>
    <div class="content-wrapper">
        <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">【客户】客户管理、公海客户<!----></h1>  <div class="theme-vdoing-content content__default"><p>本文接 <a href="/crm/clue">《【线索】线索管理》</a>，主要讲解四部分：客户信息、客户公海配置、客户限制配置、联系人。它们的表关系如下图所示：</p> <p><img src="/img/CRM%E6%89%8B%E5%86%8C/%E5%AE%A2%E6%88%B7/%E8%A1%A8%E5%85%B3%E7%B3%BB.png" alt="表关系"></p> <h2 id="_1-客户"><a href="#_1-%E5%AE%A2%E6%88%B7" class="header-anchor">#</a> 1. 客户</h2> <p>客户模块，由 <code>yudao-module-crm</code> 后端模块的 <code>customer</code> 包的 CrmCustomerController 实现，包括客户管理（我的客户）、公海客户。其中，公海客户是指没有负责人的客户，可以被人分配或者领取成为负责人。</p> <h3 id="_1-表结构"><a href="#_1-%E8%A1%A8%E7%BB%93%E6%9E%84" class="header-anchor">#</a> 1. 表结构</h3> <blockquote><p>省略 creator/create_time/updater/update_time/deleted/tenant_id 等通用字段</p></blockquote> <div class="language-SQL extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>crm_customer<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'编号，主键自增'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'客户名称'</span><span class="token punctuation">,</span>
  
  <span class="token identifier"><span class="token punctuation">`</span>owner_user_id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'负责人的用户编号'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>owner_time<span class="token punctuation">`</span></span> <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'成为负责人的时间'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>lock_status<span class="token punctuation">`</span></span> <span class="token keyword">bit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> b<span class="token string">'0'</span> <span class="token keyword">COMMENT</span> <span class="token string">'锁定状态'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>deal_status<span class="token punctuation">`</span></span> <span class="token keyword">bit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> b<span class="token string">'0'</span> <span class="token keyword">COMMENT</span> <span class="token string">'成交状态'</span><span class="token punctuation">,</span>
  
  <span class="token identifier"><span class="token punctuation">`</span>follow_up_status<span class="token punctuation">`</span></span> <span class="token keyword">tinyint</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">'0'</span> <span class="token keyword">COMMENT</span> <span class="token string">'跟进状态'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>contact_last_time<span class="token punctuation">`</span></span> <span class="token keyword">datetime</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'最后跟进时间'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>contact_last_content<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'最后跟进内容'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>contact_next_time<span class="token punctuation">`</span></span> <span class="token keyword">datetime</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'下次联系时间'</span><span class="token punctuation">,</span>
  
  <span class="token identifier"><span class="token punctuation">`</span>mobile<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'手机'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>telephone<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'电话'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>qq<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'QQ'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>wechat<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'微信'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>email<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'邮箱'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>area_id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'地区编号'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>detail_address<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'详细地址'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>industry_id<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'所属行业'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>level<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'客户等级'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>source<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'客户来源'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>remark<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'备注'</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">BTREE</span><span class="token punctuation">,</span>
  <span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>owner_user_id<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>owner_user_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">BTREE</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">17</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8mb4 <span class="token keyword">COLLATE</span><span class="token operator">=</span>utf8mb4_unicode_ci <span class="token keyword">COMMENT</span><span class="token operator">=</span><span class="token string">'CRM 客户表'</span><span class="token punctuation">;</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">友情提示：客户表的字段，和线索表的字段类似，只是多了 `lock_status`、`deal_status` 字段。</p></div> <p>① <code>owner_user_id</code> 字段：客户的负责人编号，和线索类似。不重复赘述，详细可见 <a href="/crm/permission/">《【通用】数据权限》</a> 文档。</p> <p>差别在多了 <code>owner_time</code> 字段，成为负责人超过一定时间后，客户自动释放进入公海。当然，如果客户被 <code>lock_status</code> 锁定，或者有 <code>deal_status</code> 成交，就不会释放。</p> <p>② 从 <code>follow_up_status</code> 到 <code>contact_next_time</code> 字段：跟进相关，和线索类似。不重复赘述，详细可见 <a href="/crm/follow-up/">《【通用】跟进记录》</a> 文档。</p> <p>③ 从 <code>mobile</code> 到 <code>remark</code> 字段：客户的基本信息，和客户一致，不重复赘述。</p> <h3 id="_1-2-管理后台-客户管理"><a href="#_1-2-%E7%AE%A1%E7%90%86%E5%90%8E%E5%8F%B0-%E5%AE%A2%E6%88%B7%E7%AE%A1%E7%90%86" class="header-anchor">#</a> 1.2 管理后台（客户管理）</h3> <p>对应 [CRM 系统 -&gt; 客户管理] 菜单，对应 <code>yudao-ui-admin-vue3</code> 项目的 <code>@/views/crm/customer</code> 目录。</p> <p><img src="/img/CRM%E6%89%8B%E5%86%8C/%E5%AE%A2%E6%88%B7/%E5%AE%A2%E6%88%B7%E7%AE%A1%E7%90%86.png" alt="客户管理"></p> <p>① 点击【新增】按钮，随便填写一些信息，点击「确认」按钮，即可新增一条客户。如下图所示：</p> <p><img src="/img/CRM%E6%89%8B%E5%86%8C/%E5%AE%A2%E6%88%B7/%E5%AE%A2%E6%88%B7%E6%96%B0%E5%A2%9E.png" alt="新增客户"></p> <p>② 点击“客户名称”，进入客户详情页，可以查看客户的详细信息，如下图所示：</p> <p><img src="/img/CRM%E6%89%8B%E5%86%8C/%E5%AE%A2%E6%88%B7/%E5%AE%A2%E6%88%B7%E8%AF%A6%E6%83%85.png" alt="客户详情"></p> <p>③ 点击【更改成交状态】按钮，标记客户 <code>deal_status</code> 为已成交，这样它就不会自动进入公海。</p> <p><img src="/img/CRM%E6%89%8B%E5%86%8C/%E5%AE%A2%E6%88%B7/%E5%AE%A2%E6%88%B7%E6%88%90%E4%BA%A4.png" alt="客户成交"></p> <p>同理，点击【更改锁定状态】按钮，标记客户 <code>lock_status</code> 为已锁定。</p> <p><img src="/img/CRM%E6%89%8B%E5%86%8C/%E5%AE%A2%E6%88%B7/%E5%AE%A2%E6%88%B7%E9%94%81%E5%AE%9A.png" alt="客户锁定"></p> <h3 id="_1-3-管理后台-公海客户"><a href="#_1-3-%E7%AE%A1%E7%90%86%E5%90%8E%E5%8F%B0-%E5%85%AC%E6%B5%B7%E5%AE%A2%E6%88%B7" class="header-anchor">#</a> 1.3 管理后台（公海客户）</h3> <p>① 点击【放入公海】按钮，将 <code>owner_user_id</code> 字段置空，即可放入公海。</p> <p><img src="/img/CRM%E6%89%8B%E5%86%8C/%E5%AE%A2%E6%88%B7/%E5%AE%A2%E6%88%B7%E6%94%BE%E5%85%A5%E5%85%AC%E6%B5%B7.png" alt="客户放入公海"></p> <p>放入公海后，可以在 [CRM 系统 -&gt; 公海客户] 菜单中，可以看到该客户。如下图所示：</p> <p><img src="/img/CRM%E6%89%8B%E5%86%8C/%E5%AE%A2%E6%88%B7/%E5%85%AC%E6%B5%B7%E5%AE%A2%E6%88%B7.png" alt="公海客户"></p> <p>② 继续点击该公海客户的“客户名称”，还是进入客户详情页，如下图所示：</p> <p><img src="/img/CRM%E6%89%8B%E5%86%8C/%E5%AE%A2%E6%88%B7/%E5%85%AC%E6%B5%B7%E5%AE%A2%E6%88%B7%E8%AF%A6%E6%83%85.png" alt="公海客户详情"></p> <p>③ 此时，可以点击【领取】或【分配】按钮，将公海客户分配给自己或者其它人。如下图所示：</p> <p><img src="/img/CRM%E6%89%8B%E5%86%8C/%E5%AE%A2%E6%88%B7/%E5%85%AC%E6%B5%B7%E5%AE%A2%E6%88%B7%E9%A2%86%E5%8F%96.png" alt="公海客户领取"></p> <p><img src="/img/CRM%E6%89%8B%E5%86%8C/%E5%AE%A2%E6%88%B7/%E5%85%AC%E6%B5%B7%E5%AE%A2%E6%88%B7%E5%88%86%E9%85%8D.png" alt="公海客户分配"></p> <h2 id="_2-客户限制配置"><a href="#_2-%E5%AE%A2%E6%88%B7%E9%99%90%E5%88%B6%E9%85%8D%E7%BD%AE" class="header-anchor">#</a> 2. 客户限制配置</h2> <p>客户限制配置，由 <code>yudao-module-crm</code> 后端模块的 <code>customer</code> 包的 CrmCustomerLimitConfigController 实现。</p> <h3 id="_2-1-表结构"><a href="#_2-1-%E8%A1%A8%E7%BB%93%E6%9E%84" class="header-anchor">#</a> 2.1 表结构</h3> <blockquote><p>省略 creator/create_time/updater/update_time/deleted/tenant_id 等通用字段</p></blockquote> <div class="language-SQL extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>crm_customer_limit_config<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'编号'</span><span class="token punctuation">,</span>
  
  <span class="token identifier"><span class="token punctuation">`</span>type<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'规则类型 1: 拥有客户数限制，2:锁定客户数限制'</span><span class="token punctuation">,</span>
  
  <span class="token identifier"><span class="token punctuation">`</span>user_ids<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci <span class="token keyword">DEFAULT</span> <span class="token string">''</span> <span class="token keyword">COMMENT</span> <span class="token string">'规则适用人群'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>dept_ids<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci <span class="token keyword">DEFAULT</span> <span class="token string">''</span> <span class="token keyword">COMMENT</span> <span class="token string">'规则适用部门'</span><span class="token punctuation">,</span>
  
  <span class="token identifier"><span class="token punctuation">`</span>max_count<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'数量上限'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>deal_count_enabled<span class="token punctuation">`</span></span> <span class="token keyword">tinyint</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'成交客户是否占有拥有客户数(当 type = 1 时)'</span><span class="token punctuation">,</span>
  
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">BTREE</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8mb4 <span class="token keyword">COLLATE</span><span class="token operator">=</span>utf8mb4_unicode_ci <span class="token keyword">COMMENT</span><span class="token operator">=</span><span class="token string">'CRM 客户限制配置表'</span><span class="token punctuation">;</span>
</code></pre></div><p>① <code>type</code> 字段：规则类型，1 表示拥有客户数限制，2 表示锁定客户数限制。这样的话，可以避免一个人拥有太多客户，或者锁定太多客户。</p> <p>② <code>user_ids</code> 和 <code>dept_ids</code> 字段：规则适用人群和部门，可以根据人群和部门来限制客户数量。</p> <p>③ <code>max_count</code> 字段：数量上限，即最多拥有或者锁定的客户数量。</p> <p><code>deal_count_enabled</code> 字段：成交客户是否占有拥有客户数，当 <code>type</code> = 1 时，表示成交客户是否占有拥有客户数。这样的话，可以避免一个人拥有太多成交客户。</p> <h3 id="_2-2-管理后台"><a href="#_2-2-%E7%AE%A1%E7%90%86%E5%90%8E%E5%8F%B0" class="header-anchor">#</a> 2.2 管理后台</h3> <p>对应 [CRM 系统 -&gt; 系统配置 -&gt; 客户限制配置] 菜单，对应 <code>yudao-ui-admin-vue3</code> 项目的 <code>@/views/crm/limitConfig</code> 目录。</p> <p><img src="/img/CRM%E6%89%8B%E5%86%8C/%E5%AE%A2%E6%88%B7/%E5%AE%A2%E6%88%B7%E9%99%90%E5%88%B6%E9%85%8D%E7%BD%AE-%E6%8B%A5%E6%9C%89%E5%AE%A2%E6%88%B7%E6%95%B0%E9%99%90%E5%88%B6.png" alt="拥有客户数限制"></p> <p><img src="/img/CRM%E6%89%8B%E5%86%8C/%E5%AE%A2%E6%88%B7/%E5%AE%A2%E6%88%B7%E9%99%90%E5%88%B6%E9%85%8D%E7%BD%AE-%E9%94%81%E5%AE%9A%E5%AE%A2%E6%88%B7%E6%95%B0%E9%99%90%E5%88%B6.png" alt="锁定客户数限制"></p> <h2 id="_3-客户公海配置"><a href="#_3-%E5%AE%A2%E6%88%B7%E5%85%AC%E6%B5%B7%E9%85%8D%E7%BD%AE" class="header-anchor">#</a> 3. 客户公海配置</h2> <p>客户公海配置，由 <code>yudao-module-crm</code> 后端模块的 <code>customer</code> 包的 CrmCustomerPoolConfigController 实现。</p> <h3 id="_3-1-表结构"><a href="#_3-1-%E8%A1%A8%E7%BB%93%E6%9E%84" class="header-anchor">#</a> 3.1 表结构</h3> <blockquote><p>省略 creator/create_time/updater/update_time/deleted/tenant_id 等通用字段</p></blockquote> <div class="language-SQL extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>crm_customer_pool_config<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'编号'</span><span class="token punctuation">,</span>
  
  <span class="token identifier"><span class="token punctuation">`</span>enabled<span class="token punctuation">`</span></span> <span class="token keyword">tinyint</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'是否启用客户公海'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>contact_expire_days<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'未跟进放入公海天数'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>deal_expire_days<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'未成交放入公海天数'</span><span class="token punctuation">,</span>
  
  <span class="token identifier"><span class="token punctuation">`</span>notify_enabled<span class="token punctuation">`</span></span> <span class="token keyword">tinyint</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'是否开启提前提醒'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>notify_days<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'提前提醒天数'</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">BTREE</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8mb4 <span class="token keyword">COLLATE</span><span class="token operator">=</span>utf8mb4_unicode_ci <span class="token keyword">COMMENT</span><span class="token operator">=</span><span class="token string">'CRM 客户公海配置表'</span><span class="token punctuation">;</span>
</code></pre></div><p>① <code>enabled</code> 字段：是否启用客户公海。如果启用，那么超过 <code>contact_expire_days</code> 天未跟进的客户，或者超过 <code>deal_expire_days</code> 天未成交的客户，就会自动进入公海。</p> <p>目前，该功能是通过 CrmCustomerAutoPutPoolJob 定时任务实现的。你可以参考 <a href="/job/">《定时任务》</a> 文档，自己配置每 5 分钟执行一次。</p> <p>② <code>notify_enabled</code> 字段：是否开启提前提醒。如果开启，那么超过 <code>notify_days</code> 天未跟进的客户，或者超过 <code>notify_days</code> 天未成交的客户，可以在 [CRM 系统 -&gt; 待办事项] 菜单中，看到提醒。如下图所示：</p> <p><img src="/img/CRM%E6%89%8B%E5%86%8C/%E5%AE%A2%E6%88%B7/%E5%BE%85%E5%8A%9E%E4%BA%8B%E9%A1%B9-%E5%BE%85%E8%BF%9B%E5%85%A5%E5%85%AC%E6%B5%B7%E7%9A%84%E5%AE%A2%E6%88%B7.png" alt="待进入公海的客户"></p> <h3 id="_3-2-管理后台"><a href="#_3-2-%E7%AE%A1%E7%90%86%E5%90%8E%E5%8F%B0" class="header-anchor">#</a> 3.2 管理后台</h3> <p>对应 [CRM 系统 -&gt; 系统配置 -&gt; 客户公海配置] 菜单，对应 <code>yudao-ui-admin-vue3</code> 项目的 <code>@/views/crm/poolConfig</code> 目录。</p> <p><img src="/img/CRM%E6%89%8B%E5%86%8C/%E5%AE%A2%E6%88%B7/%E5%AE%A2%E6%88%B7%E5%85%AC%E6%B5%B7%E9%85%8D%E7%BD%AE.png" alt="客户公海配置"></p> <h2 id="_4-联系人"><a href="#_4-%E8%81%94%E7%B3%BB%E4%BA%BA" class="header-anchor">#</a> 4. 联系人</h2> <p>联系人模块，由 <code>yudao-module-crm</code> 后端模块的 <code>contact</code> 包实现。</p> <h3 id="_4-1-表结构"><a href="#_4-1-%E8%A1%A8%E7%BB%93%E6%9E%84" class="header-anchor">#</a> 4.1 表结构</h3> <blockquote><p>省略 creator/create_time/updater/update_time/deleted/tenant_id 等通用字段</p></blockquote> <div class="language-SQL extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>crm_contact<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'主键'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'联系人名称'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>customer_id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'客户编号'</span><span class="token punctuation">,</span>

  <span class="token identifier"><span class="token punctuation">`</span>owner_user_id<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'负责人用户编号'</span><span class="token punctuation">,</span>
  
  <span class="token identifier"><span class="token punctuation">`</span>contact_last_time<span class="token punctuation">`</span></span> <span class="token keyword">datetime</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'最后跟进时间'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>contact_last_content<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'最后跟进内容'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>contact_next_time<span class="token punctuation">`</span></span> <span class="token keyword">datetime</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'下次联系时间'</span><span class="token punctuation">,</span>
  
  <span class="token identifier"><span class="token punctuation">`</span>mobile<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'手机号'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>telephone<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'电话'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>email<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'电子邮箱'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>qq<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>wechat<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>area_id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'地区'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>detail_address<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'地址'</span><span class="token punctuation">,</span>
  
  <span class="token identifier"><span class="token punctuation">`</span>sex<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'性别'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>master<span class="token punctuation">`</span></span> <span class="token keyword">bit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'是否关键决策人'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>parent_id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'直系上属'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>post<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'职务'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>tenant_id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">BTREE</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">16</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8mb4 <span class="token keyword">COLLATE</span><span class="token operator">=</span>utf8mb4_unicode_ci <span class="token keyword">COMMENT</span><span class="token operator">=</span><span class="token string">'CRM 联系人'</span><span class="token punctuation">;</span>
</code></pre></div><p>① <code>customer_id</code> 字段：联系人所属的客户编号，它必须关联到客户表的 <code>id</code> 字段。</p> <p>② <code>owner_user_id</code> 字段：联系人的负责人编号，和线索类似。不重复赘述，详细可见 <a href="/crm/permission/">《【通用】数据权限》</a> 文档。</p> <p>③ 从 <code>contact_last_time</code> 到 <code>contact_next_time</code> 字段：跟进相关，和线索类似。不重复赘述，详细可见 <a href="/crm/follow-up/">《【通用】跟进记录》</a> 文档。</p> <p>④ 从 <code>mobile</code> 到 <code>detail_address</code> 字段：联系人的基本信息，和客户一致，不重复赘述。</p> <p>差异的点，是额外增加了 <code>sex</code>、<code>master</code>、<code>parent_id</code>、<code>post</code> 字段。不过它们也是信息字段，没有什么特殊逻辑。</p> <h3 id="_4-2-管理后台"><a href="#_4-2-%E7%AE%A1%E7%90%86%E5%90%8E%E5%8F%B0" class="header-anchor">#</a> 4.2 管理后台</h3> <p>对应 [CRM 系统 -&gt; 联系人管理] 菜单，对应 <code>yudao-ui-admin-vue3</code> 项目的 <code>@/views/crm/contact</code> 目录。</p> <p><img src="/img/CRM%E6%89%8B%E5%86%8C/%E5%AE%A2%E6%88%B7/%E8%81%94%E7%B3%BB%E4%BA%BA%E7%AE%A1%E7%90%86.png" alt="联系人管理"></p> <p>① 点击【新增】按钮，随便填写一些信息，点击「确认」按钮，即可新增一条联系人。如下图所示：</p> <p><img src="/img/CRM%E6%89%8B%E5%86%8C/%E5%AE%A2%E6%88%B7/%E8%81%94%E7%B3%BB%E4%BA%BA%E6%96%B0%E5%A2%9E.png" alt="新增联系人"></p> <p>② 点击“联系人名称”，进入联系人详情页，可以查看联系人的详细信息，如下图所示：</p> <p><img src="/img/CRM%E6%89%8B%E5%86%8C/%E5%AE%A2%E6%88%B7/%E8%81%94%E7%B3%BB%E4%BA%BA%E8%AF%A6%E6%83%85.png" alt="联系人详情"></p> <p>具体操作比较简单，只有【编辑】、【转移】，所以联系人本质上还是客户的信息补充。</p></div></div>
    </div>
</body>
</html>